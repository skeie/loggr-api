{"version":3,"sources":["../../server/users/userService.js"],"names":["jwtToken","require","Service","dao","commonDao","createUser","getUser","user","email","then","ourUser","image","update","id","url","Boolean","generateToken","userDAO","CommonDao"],"mappings":";;;;;;;;;;AAAA,IAAMA,WAAWC,QAAQ,kBAAR,CAAjB;;IAEqBC,O,GACnB,iBAAYC,GAAZ,EAAiBC,SAAjB,EAA4B;AAAA;;AAAA;;AAAA,OAO5BC,UAP4B,GAOf,gBAAQ;AACnB,WAAO,MAAKF,GAAL,CAASG,OAAT,CAAiBC,KAAKC,KAAtB,EAA6BC,IAA7B,CAAkC,mBAAW;AAClD,UAAI,CAACC,QAAQC,KAAb,EACE,MAAKP,SAAL,CAAeQ,MAAf,CAAsBF,QAAQG,EAA9B,EAAkC,EAAEF,OAAOJ,KAAKO,GAAd,EAAlC,EAAuD,OAAvD;AACF,aAAOC,QAAQL,OAAR,iBACEA,OADF,IACWV,UAAUA,SAASgB,aAAT,CAAuBN,OAAvB,CADrB,MAEH,MAAKP,GAAL,CAASE,UAAT,CAAoBE,IAApB,EAA0BE,IAA1B,CAA+B;AAAA,4BAC1BF,IAD0B;AAE7BM,gBAF6B;AAG7Bb,oBAAUA,SAASgB,aAAT,cAA4BT,IAA5B,IAAkCM,MAAlC;AAHmB;AAAA,OAA/B,CAFJ;AAOD,KAVM,CAAP;AAWD,GAnB2B;;AAC1B,MAAMI,UAAUd,OAAOF,QAAQ,WAAR,CAAvB;AACA,MAAMiB,YAAYd,aAAaH,QAAQ,eAAR,CAA/B;AACA,OAAKE,GAAL,GAAW,IAAIc,OAAJ,EAAX;AACA,OAAKb,SAAL,GAAiB,IAAIc,SAAJ,EAAjB;AACD,C;;kBANkBhB,O","file":"userService.js","sourcesContent":["const jwtToken = require(\"../util/jwtToken\");\n\nexport default class Service {\n  constructor(dao, commonDao) {\n    const userDAO = dao || require(\"./userDAO\");\n    const CommonDao = commonDao || require(\"../common/dao\");\n    this.dao = new userDAO();\n    this.commonDao = new CommonDao();\n  }\n\n  createUser = user => {\n    return this.dao.getUser(user.email).then(ourUser => {\n      if (!ourUser.image)\n        this.commonDao.update(ourUser.id, { image: user.url }, \"users\");\n      return Boolean(ourUser)\n        ? { ...ourUser, jwtToken: jwtToken.generateToken(ourUser) }\n        : this.dao.createUser(user).then(id => ({\n            ...user,\n            id,\n            jwtToken: jwtToken.generateToken({ ...user, id })\n          }));\n    });\n  };\n}\n"]}